-- create table if not exists shopeefood.shopeefood_mart_cdm_dwd_vn_driverwallet_wallet_order_da
-- (id       decimal(20,0),
-- driver_id       decimal(20,0),
-- wallet_id       decimal(20,0),
-- order_type       int,
-- order_status       int,
-- amount       bigint,
-- operator       string,
-- adjust_reason       int,
-- cancel_reason       int,
-- remark       string,
-- escrow_certs       string,
-- escrow_no       string,
-- bank_name       string,
-- bank_account_no       string,
-- transaction_ref       decimal(20,0),
-- payment_method       int,
-- payment_channel_id       decimal(20,0),
-- payment_channel_option       string,
-- payment_link       string,
-- currency       string,
-- region       string,
-- initial_time       decimal(20,0),
-- payment_time       decimal(20,0),
-- adjust_time       decimal(20,0),
-- reject_time       decimal(20,0),
-- complete_time       decimal(20,0),
-- cancel_time       decimal(20,0),
-- create_time       decimal(20,0),
-- update_time       decimal(20,0),
-- payout_mode       bigint,
-- payment_error_code       string,
-- audit_result       int,
-- audit_remark       string,
-- audit_operator       string,
-- audit_time       decimal(20,0),
-- cancel_source       int,
-- estimate_approve_time       decimal(20,0),
-- payout_notify_time       decimal(20,0),
-- bank_account_holder       string,
-- shopee_user_id       decimal(20,0),
-- shopee_user_name       string,
-- withdrawal_channel       bigint,
-- service_type       bigint,
-- shopeepay_mobile       string)
-- partitioned by (dt date)
-- stored as orcfile;
insert overwrite shopeefood.shopeefood_mart_cdm_dwd_vn_driverwallet_wallet_order_da
PARTITION(dt='${local_date}')
SELECT /*+ COALESCE(20) */
id
,driver_id
,wallet_id
,order_type
,order_status
,amount
,operator
,adjust_reason
,cancel_reason
,remark
,escrow_certs
,escrow_no
,bank_name
,bank_account_no
,transaction_ref
,payment_method
,payment_channel_id
,payment_channel_option
,payment_link
,currency
,region
,initial_time
,payment_time
,adjust_time
,reject_time
,complete_time
,cancel_time
,create_time
,update_time
,payout_mode
,payment_error_code
,audit_result
,audit_remark
,audit_operator
,audit_time
,cancel_source
,estimate_approve_time
,payout_notify_time
,bank_account_holder
,shopee_user_id
,shopee_user_name
,withdrawal_channel
,service_type
,shopeepay_mobile
from shopeefood.shopee_foody_driverwallet_vn_db__wallet_order_tab__reg_daily_s0_live